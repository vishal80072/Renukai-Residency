{"version":3,"file":"static/js/898.4a537512.chunk.js","mappings":"yLAIA,IAJoB,SAAH,GAAsB,IAAhBA,EAAQ,EAARA,SACnB,OAAO,wBAAKA,GAChB,C,yNC0HA,UA9GiB,YAEIC,EAAAA,EAAAA,MAAjB,IAEA,GAAwCC,EAAAA,EAAAA,UAAS,IAAG,eAA7CC,EAAY,KAAEC,EAAe,KAEpC,GAA4CF,EAAAA,EAAAA,UAAS,GAAE,eAAhCG,GAAF,KAAmB,MACxC,GAAkCH,EAAAA,EAAAA,WAAS,GAAM,eAA1CI,EAAS,KAAEC,EAAY,KAmE9B,OAJAC,EAAAA,EAAAA,YAAU,YA7DO,WAEbD,GAAa,GACb,IAAME,GAAIC,EAAAA,EAAAA,KAAMC,EAAAA,EAAAA,IAAWC,EAAAA,GAAI,iBAAiBC,EAAAA,EAAAA,IAAQ,OAAQ,UAEhEC,EAAAA,EAAAA,IAAQL,GAAGM,MAAK,SAAAC,GACZ,IAAMC,EAAW,GACbC,EAAU,EACdF,EAAGG,SAAQ,SAAAC,GACiB,QAApBA,EAAIC,OAAOC,KACe,aAAtBF,EAAIC,OAAOE,SACXL,GAAWM,SAASJ,EAAIC,OAAOI,SAIT,aAAtBL,EAAIC,OAAOE,SACXL,GAAWM,SAASJ,EAAIC,OAAOI,SAGvCR,EAASS,MAAK,QAAEC,KAAMC,IAAOR,EAAIC,OAAOQ,MAAMC,OAAO,gBAAmBV,EAAIC,QAChF,IACAhB,EAAkBa,GAClBd,EAAgBa,GAChBV,GAAa,EACjB,GACJ,CAqCIwB,EACJ,GAAG,KAEI,+BACH,SAAC,IAAc,CAACC,OAAQ1B,EACpB2B,SAAO,EACPC,KAAK,iBAAgB,UACrB,SAAC,KAAI,WACD,UAAC,KAAK,YACF,SAAC,KAAW,CAACC,UAAU,iCAAgC,UACnD,SAAC,IAAW,UAAC,6BAKjB,SAAC,KAAS,WACN,SAAC,KAAO,CAACC,QAAQ,UAAUD,UAAU,aAAaE,QAnD9C,WACpB,IAAMhB,EAAO,GACblB,EAAagB,SAAQ,SAAAmB,GACjBjB,EAAKK,KAAK,CACN,WAAaY,EAAEC,cACf,OAAWD,EAAEb,OACb,KAAoB,QAAXa,EAAEhB,KAAiB,SAAW,YACvC,KAASgB,EAAEX,KACX,OAAWW,EAAEf,OAAOiB,OAAO,GAAGC,cAAgBH,EAAEf,OAAOmB,MAAM,GAC7D,OAAWJ,EAAEK,QAErB,IAEA,IAAMC,EAAM,IAAIC,EAAAA,QACVC,EAAeC,OAAOC,KAAK3B,EAAK,IAChC4B,EAAY5B,EAAK6B,KAAI,SAAAC,GAAG,OAAIJ,OAAOK,OAAOD,EAAI,IAEpDP,EAAIV,KAAK,mCAAoC,GAAI,IACjDU,EAAIS,UAAU,CACVC,OAAQ,GACRC,KAAM,CAACT,GACPU,KAAMP,EACNQ,WAAY,CACRC,UAAW,UACXC,UAAW,CAAC,IAAK,IAAK,KACtBC,SAAU,GACVC,UAAW,UAIjB,IAAMC,EAAUlB,EAAImB,SACpBC,IAAaF,EAAS,qCAC5B,EAmB+F,SAAC,wCAqBpG,C","sources":["components/PageHeading.js","views/download/Download.js"],"sourcesContent":["const PageHeading = ({ children }) => {\r\n    return <h5>{children}</h5>\r\n}\r\n\r\nexport default PageHeading","\r\nimport { CCard, CCardHeader, CCardBody, CCol, CButton } from '@coreui/react'\r\nimport { collection, getDocs, query, orderBy } from 'firebase/firestore'\r\nimport 'react-super-responsive-table/dist/SuperResponsiveTableStyle.css';\r\nimport { useEffect, useState } from 'react';\r\nimport LoadingOverlay from 'react-loading-overlay';\r\nimport { db } from 'src/firebase/FirebaseProvider'\r\nimport moment from 'moment';\r\nimport PageHeading from 'src/components/PageHeading';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport jsPDF from 'jspdf';\r\nimport fileDownload from 'js-file-download';\r\nimport 'jspdf-autotable';\r\n\r\nconst Download = () => {\r\n\r\n    const navigate = useNavigate()\r\n\r\n    const [Transactions, setTransactions] = useState([])\r\n\r\n    const [currentBalance, setCurrentBalance] = useState(0)\r\n    const [isLoading, setIsLoading] = useState(false)\r\n\r\n    const loadData = () => {\r\n\r\n        setIsLoading(true)\r\n        const q = query(collection(db, \"transactions\"), orderBy(\"date\", \"desc\"));\r\n\r\n        getDocs(q).then(rs => {\r\n            const tempMain = []\r\n            let balance = 0\r\n            rs.forEach(doc => {\r\n                if (doc.data().type === 'add') {\r\n                    if (doc.data().status === 'approved') {\r\n                        balance += parseInt(doc.data().amount)\r\n                    }\r\n\r\n                } else {\r\n                    if (doc.data().status === 'approved') {\r\n                        balance -= parseInt(doc.data().amount)\r\n                    }\r\n                }\r\n                tempMain.push({ Date: moment(doc.data().date).format(\"DD MMM YYYY\"), ...doc.data() })\r\n            })\r\n            setCurrentBalance(balance)\r\n            setTransactions(tempMain)\r\n            setIsLoading(false)\r\n        });\r\n    }\r\n\r\n    const onClickDownload = () => {\r\n        const data = []\r\n        Transactions.forEach(x => {\r\n            data.push({\r\n                \"Entry By\" : x.transactionBy,\r\n                \"Amount\" : x.amount,\r\n                \"Type\" : x.type === \"add\" ? \"Credit\" : \"Deduction\",\r\n                \"Date\" : x.Date,\r\n                \"Status\" : x.status.charAt(0).toUpperCase() + x.status.slice(1),\r\n                \"Remark\" : x.remark,\r\n            })\r\n        })\r\n\r\n        const pdf = new jsPDF();\r\n        const tableHeaders = Object.keys(data[0]);\r\n        const tableData = data.map(obj => Object.values(obj));\r\n\r\n        pdf.text('Renukai Residency - Transactions', 70, 10);\r\n        pdf.autoTable({\r\n            startY: 15,\r\n            head: [tableHeaders],\r\n            body: tableData,\r\n            headStyles: {\r\n                fillColor: \"#1a7da0\", // Set a custom fill color for the table headers\r\n                textColor: [255, 255, 255], // Set a custom text color for the table headers\r\n                fontSize: 12, // Set a custom font size for the table headers\r\n                fontStyle: 'bold', // Set the font style to bold for the table headers\r\n            },\r\n        });\r\n\r\n          const pdfData = pdf.output();\r\n          fileDownload(pdfData, 'Renukai Residency Transactions.pdf');\r\n    }\r\n\r\n    useEffect(() => {\r\n        loadData()\r\n    }, [])\r\n\r\n    return <>\r\n        <LoadingOverlay active={isLoading}\r\n            spinner\r\n            text='Please wait...'>\r\n            <CCol>\r\n                <CCard>\r\n                    <CCardHeader className='d-flex justify-content-between'>\r\n                        <PageHeading>\r\n                            Download Transactions\r\n                        </PageHeading>\r\n                        {/* <CButton variant=\"outline\" onClick={onDateJump}>Date Jump</CButton> */}\r\n                    </CCardHeader>\r\n                    <CCardBody>\r\n                        <CButton variant='outline' className='w-100 mb-1' onClick={onClickDownload}>Download All Transactions</CButton>\r\n                        {/* <CButton variant='outline' className='w-100 mb-1'>Last Month</CButton>\r\n                        <CButton variant='outline' className='w-100 mb-1'>This Year</CButton>\r\n                        <CButton variant='outline' className='w-100 mb-1'>Last Year</CButton> */}\r\n                    </CCardBody>\r\n                </CCard>\r\n            </CCol>\r\n            {/* <CCol className='mt-3'>\r\n                <CCard>\r\n                    <CCardHeader className='d-flex justify-content-between'>\r\n                        <PageHeading>\r\n                            Download Water Days\r\n                        </PageHeading>\r\n                    </CCardHeader>\r\n                    <CCardBody>\r\n                        <CButton variant='outline' className='w-100 mb-1'>Download Water Days</CButton>\r\n                    </CCardBody>\r\n                </CCard>\r\n            </CCol > */}\r\n        </LoadingOverlay>\r\n    </>\r\n}\r\n\r\nexport default Download"],"names":["children","useNavigate","useState","Transactions","setTransactions","setCurrentBalance","isLoading","setIsLoading","useEffect","q","query","collection","db","orderBy","getDocs","then","rs","tempMain","balance","forEach","doc","data","type","status","parseInt","amount","push","Date","moment","date","format","loadData","active","spinner","text","className","variant","onClick","x","transactionBy","charAt","toUpperCase","slice","remark","pdf","jsPDF","tableHeaders","Object","keys","tableData","map","obj","values","autoTable","startY","head","body","headStyles","fillColor","textColor","fontSize","fontStyle","pdfData","output","fileDownload"],"sourceRoot":""}